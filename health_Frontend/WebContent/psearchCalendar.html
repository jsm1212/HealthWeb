<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="shortcut icon" type="image⁄x-icon" href="https://firebasestorage.googleapis.com/v0/b/healthapp-client.appspot.com/o/images%2Fhome.png?alt=media&token=c30ebcc4-6ca5-4745-a01e-ecaf8e97d972">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link href="css/psearchCalendar.css?a" rel="stylesheet" />
<title>Insert title here</title>
<style>
/*datepicer 버튼 롤오버 시 손가락 모양 표시*/
.ui-datepicker-trigger{cursor: pointer;}
/*datepicer input 롤오버 시 손가락 모양 표시*/
.hasDatepicker{cursor: pointer;}
</style>
</head>
<body>
<br><br><br><br>
<div align="center">
 From: <input type="text" id="startDate">
 &nbsp &nbsp &nbsp
    To: <input type="text" id="endDate">
</div>
<br>
<div align="center">
<button type="button" class="btn btn-primary" id="searchBtn" style="margin-right: 4%;">검색</button>
<button type="button" class="btn btn-primary" id="menuBtn">메뉴</button>
</div>
<br><br>

<div class="conteainer" >
	<div class ="row"  >
		<table class="table table-striped" style="text-align: center; border:1px solid #dddddd; width:50%;  margin: auto;" >
			<thead>
				<tr>
					<th style="backgroud-color: #eeeeee; text-align: center;">번호</th>
					<th style="backgroud-color: #eeeeee; text-align: center;">날짜</th>
					<th style="backgroud-color: #eeeeee; text-align: center;">내용</th>
				</tr>
			</thead>
			
			<tbody id="tbody">
				<!-- <tr>
					<td>1</td>
					<td>20220413</td>
					<td>첫글입니다.</td>
				</tr> -->
			</tbody>
			
		</table>
	</div>
</div>
</body>
<script>

//로그인 가져오는부분
let str = sessionStorage.getItem("login");
//가져온 로그인정보를 json형태로 변환
let userInfo = JSON.parse(str);

//값 가져오기


var data = $( "#startDate" ).datepicker( "getDate" );
$(function() {
    //모든 datepicker에 대한 공통 옵션 설정
    $.datepicker.setDefaults({
        dateFormat: 'yy-mm-dd' //Input Display Format 변경
        ,showOtherMonths: true //빈 공간에 현재월의 앞뒤월의 날짜를 표시
        ,showMonthAfterYear:true //년도 먼저 나오고, 뒤에 월 표시
        ,changeYear: true //콤보박스에서 년 선택 가능
        ,changeMonth: true //콤보박스에서 월 선택 가능                
        ,showOn: "both" //button:버튼을 표시하고,버튼을 눌러야만 달력 표시 ^ both:버튼을 표시하고,버튼을 누르거나 input을 클릭하면 달력 표시  
        ,buttonImage: "http://jqueryui.com/resources/demos/datepicker/images/calendar.gif" //버튼 이미지 경로
        ,buttonImageOnly: true //기본 버튼의 회색 부분을 없애고, 이미지만 보이게 함
        ,buttonText: "선택" //버튼에 마우스 갖다 댔을 때 표시되는 텍스트                
        ,yearSuffix: "년" //달력의 년도 부분 뒤에 붙는 텍스트
        ,monthNamesShort: ['1','2','3','4','5','6','7','8','9','10','11','12'] //달력의 월 부분 텍스트
        ,monthNames: ['1월','2월','3월','4월','5월','6월','7월','8월','9월','10월','11월','12월'] //달력의 월 부분 Tooltip 텍스트
        ,dayNamesMin: ['일','월','화','수','목','금','토'] //달력의 요일 부분 텍스트
        ,dayNames: ['일요일','월요일','화요일','수요일','목요일','금요일','토요일'] //달력의 요일 부분 Tooltip 텍스트
        ,minDate: "-10Y" //최소 선택일자(-1D:하루전, -1M:한달전, -1Y:일년전)
        ,maxDate: "+10Y" //최대 선택일자(+1D:하루후, +1M:한달후, +1Y:일년후)                    
    });

    //input을 datepicker로 선언
    $("#startDate").datepicker();                    
    $("#endDate").datepicker();
    
    //From의 초기값을 오늘 날짜로 설정
    $('#startDate').datepicker('setDate', 'today'); //(-1D:하루전, -1M:한달전, -1Y:일년전), (+1D:하루후, -1M:한달후, -1Y:일년후)
    //To의 초기값을 내일로 설정
    $('#endDate').datepicker('setDate', '+1D'); //(-1D:하루전, -1M:한달전, -1Y:일년전), (+1D:하루후, -1M:한달후, -1Y:일년후)
});
//메뉴 버튼
$("#menuBtn").click(function(){
	location.href = "calendar.html";
});
//검색 버튼 
$("#searchBtn").click(function(){
	startDate.value=$("#startDate").val();
	endDate.value=$("#endDate").val();

	let startStr = $("#startDate").val().replace(/-/gi,'');
	let endStr = $("#endDate").val().replace(/-/gi,'');	
	
	$("#tbody").html(""); 
	
	$.ajax({
		url:"http://localhost:3000/psearchCalendar",
		type:"get",
		data:{"startDate":startStr, "endDate":endStr, "userId":userInfo.id},
		
		// startDate, int endDate
		//startDate.value=$("#startDate").val();
		//endDate.value=$("#endDate").val();
		
		success:function(list){
			$.each(list, function(i, item){
				
				let str = "";
				
				str = '<tr>' +
							'<td>' + (i+1) + '</td>' +
							'<td>' + item.calendardate + '</td>' + 
							'<td>' + item.content + '</td>' + 
						'</tr>'
				
				//<tr>
					//<td>1</td>
					//<td>20220413</td>
					//<td>첫글입니다.</td>
				//</tr>
				
				$("#tbody").append(str);
			});
		},
		error:function(){
			alert('게시글 리스트 : error');
		}
	});
});




</script>
</html>